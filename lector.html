<style>
    .resultados-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
    }
    .card {
        border: 1px solid #ccc;
        border-radius: 8px;
        padding: 15px;
        box-shadow: 2px 2px 12px rgba(0,0,0,0.1);
    }
    .card.success {
        border-color: green;
        background-color: #e6ffe6;
    }
    .card.warning {
        border-color: orange;
        background-color: #fff5e6;
    }
    .card.danger {
        border-color: red;
        background-color: #ffe6e6;
    }
</style>

<form method="POST" 
        action="{% url 'lector_pdf' %}" 
        enctype="multipart/form-data">

    {% csrf_token %}

    <input type="file" name="archivo_pdf" accept=".pdf" required>

    <button type="submit">Analizar Hemograma</button>
</form>

<hr>
{% if datos_paciente %}
<h2>Datos del Paciente</h2>
<ul>
    <h2>Datos del Paciente</h2>
    <p><strong>Nombre:</strong> {{ datos_paciente.nombre_completo }}</p>
    <p><strong>Identificación:</strong> {{ datos_paciente.identificacion }}</p>
    <p><strong>Edad:</strong> {{ datos_paciente.edad }}</p>
    <p><strong>Sexo:</strong> {{ datos_paciente.genero_sexo }}</p>
    <p><strong>Procedencia:</strong> {{ datos_paciente.procedencia }}</p>
</ul>
<hr>
{% endif %}
<h2>Resultados del Analizador Medilector</h2>
<div class="resultados-grid">
    {% if lista_analisis %}
    {% for item in lista_analisis %}
    <div class="card {{ item.clase }}">
        <h3>{{ item.nombre }}</h3>
    
        <p><strong>Valor:</strong> {{ item.valor }}</p>
        <p><strong>Resultado:</strong> {{ item.estado }}</p>
        <p><small>{{ item.mensaje }}</small></p>
    
        {% if item.causas %}
            <hr>
            <p><strong>Posibles causas:</strong></p>
            <ul>
                {% for causa in item.causas %}
                    <li>{{ causa }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    </div> 
    {% endfor %}

{% comment %} <p>Depuración: Se encontraron {{ lista_analisis|length }} resultados.</p> {% endcomment %}

    {% else %}
    <p>No se han analizado hemogramas aún.</p>
    {% endif %}

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>